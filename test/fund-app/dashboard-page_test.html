<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>fund-app test</title>

    <script src="../../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
    <script src="../../node_modules/@polymer/test-fixture/test-fixture.js"></script>
    <script src="../../node_modules/mocha/mocha.js"></script>
    <script src="../../node_modules/chai/chai.js"></script>
    <script src="../../node_modules/wct-mocha/wct-mocha.js"></script>

    <script type="module" src="../../src/fund-app/dashboard-page.js"></script>
  </head>
  <body>

    <test-fixture id="dashboardPageFixture">
      <template>
        <dashboard-page></dashboard-page>
      </template>
    </test-fixture>


    <script>
        describe('Given dashboard Page Component:',function(){
            var element;
            var elementShadowRoot;
            it('should render container element', function () {
                         let container = elementShadowRoot.querySelector('#container')
                         expect(body).to.be.exist;
                         expect(body).to.not.null;
                     });                
                     it('should render header element', function () {
                         let header = elementShadowRoot.querySelector('header')
                         expect(header).to.be.exist;
                         expect(header).to.not.null;
                     });
                     it('should render main element', function () {
                         let main = elementShadowRoot.querySelector('main')
                         expect(main).to.be.exist;
                         expect(main).to.not.null;
                     });
                     it('should render div element', function () {
                         let container = elementShadowRoot.querySelector('#loginFields')
                         expect(body).to.be.exist;
                         expect(body).to.not.null;
                     });
                     it('should render header element', function () {
                         let form = elementShadowRoot.querySelector('h1')
                         expect(form).to.be.exist;
                         expect(form).to.not.null;
                     });
                     it('should render paper-toast field', function () {
                         let toast0 = elementShadowRoot.querySelector('paper-toast')
                         expect(toast0).to.be.exist;
                         expect(toast0).to.not.null;
                     });
                     it('should render iron-ajax component', function () {
                         let ironAjax = elementShadowRoot.querySelector('#ajax')
                         expect(ironAjax).to.be.exist;
                         expect(ironAjax).to.not.null;
                     });
            describe('when component is initialised',function(){
                beforeEach(function(){
                    element = fixture('dashboardPageFixture');
                    elementShadowRoot = element.shadowRoot;
                });
                it('should render the components',function(){
                    expect(element).to.be.exist;
                    expect(elementShadowRoot).to.be.exist;
                });
                when('the account is selected',function(){
                    let signIn;
                    let setActive;
                    beforeEach((done)=>{
                        flush(function(){
                            signIn = document.querySelector('#loginButton');
                            setActive = sinon.spy();
                            signIn.addEventListener('click',setActive);
                            done();
                        })
                    });
                    afterEach(()=>{
                        sinon.restore();
                    });
                    describe('should call _handleLogin method once',function(){
                        afterEach(function(){
                            signIn.click();
                            expect(setActive.callCount).to.be.equal(1);
                        });
                        it('should go to if statement',function(){
                            element.$.username.value='shubham@mail.com';
                            element.$.password.value='222';
                        });
                    });
                });
            });
        });

    </script>


  </body>
</html>
